import torch
from torch import nn

if __name__ == '__main__':
    torch.manual_seed(42)
    layer = nn.Linear(16,4)
    x1 = torch.randn(2,16)
    x2 = torch.randn(1,16)

    # loss = layer(x1).mean() + 0.3*layer(x2).mean()
    # loss.backward()
    loss = layer(x1).mean()
    loss.backward()
    loss = 0.3*layer(x2).mean()
    loss.backward()
    print(layer.weight.grad)

'''
tensor([[ 0.1584,  0.0847,  0.0908,  0.1324,  0.0583, -0.0169, -0.0601,  0.0754,
         -0.1235, -0.0882, -0.1091, -0.0562,  0.2531,  0.2128,  0.1680,  0.1159],
        [ 0.1584,  0.0847,  0.0908,  0.1324,  0.0583, -0.0169, -0.0601,  0.0754,
         -0.1235, -0.0882, -0.1091, -0.0562,  0.2531,  0.2128,  0.1680,  0.1159],
        [ 0.1584,  0.0847,  0.0908,  0.1324,  0.0583, -0.0169, -0.0601,  0.0754,
         -0.1235, -0.0882, -0.1091, -0.0562,  0.2531,  0.2128,  0.1680,  0.1159],
        [ 0.1584,  0.0847,  0.0908,  0.1324,  0.0583, -0.0169, -0.0601,  0.0754,
         -0.1235, -0.0882, -0.1091, -0.0562,  0.2531,  0.2128,  0.1680,  0.1159]])
'''
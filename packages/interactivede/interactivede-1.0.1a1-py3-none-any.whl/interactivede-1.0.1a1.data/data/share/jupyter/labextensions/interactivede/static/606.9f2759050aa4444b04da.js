/*! For license information please see 606.9f2759050aa4444b04da.js.LICENSE.txt */
"use strict";(self.webpackChunkinteractivede=self.webpackChunkinteractivede||[]).push([[606],{606:(e,t,r)=>{r.r(t),r.d(t,{ID:()=>p,Registry:()=>Ye,TrrackEvents:()=>Be,createAction:()=>n.PH,createRootNode:()=>h,createStateNode:()=>v,initEventManager:()=>o,initializeProvenanceGraph:()=>de,initializeTrrack:()=>Ke,isRootNode:()=>d,isStateNode:()=>l});var n=r(0);function o(){const e=new Map;return{listen:(t,r)=>(e.has(t)||e.set(t,[]),e.get(t).push(r),()=>{e.set(t,(e.get(t)||[]).filter((e=>e!==r)))}),fire(t,r){const n=e.get(t);n&&n.forEach((e=>e(r)))}}}let a;const i=new Uint8Array(16);function c(){if(!a&&(a=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}const u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));const s={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function f(e,t,r){if(s.randomUUID&&!t&&!e)return s.randomUUID();const n=(e=e||{}).random||(e.rng||c)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase()}(n)}class p{static get(){let e=f();for(;this.ids.has(e);)e=f();return this.ids.set(e,!0),e}}function l(e){return"parent"in e}function d(e){return!l(e)}function h(e){const{label:t,state:r,initialArtifact:n,initialMetadata:o}=e,a=Object.keys(o||{}).reduce(((e,t)=>(e[t]=[],o&&o[t]&&e[t].push({type:t,id:p.get(),val:o[t],createdOn:Date.now()}),e)),{annotation:[],bookmark:[]}),i=n?[{id:p.get(),createdOn:Date.now(),val:n}]:[];return{id:p.get(),label:t||"Root",event:"Root",children:[],level:0,createdOn:Date.now(),meta:a,artifacts:i,state:{type:"checkpoint",val:r}}}function v({parent:e,state:t,label:r,sideEffects:n={do:[],undo:[]},initialMetadata:o,initialArtifact:a,event:i}){const c=Object.keys(o||{}).reduce(((e,t)=>(e[t]=[],o&&o[t]&&e[t].push({type:t,id:p.get(),val:o[t],createdOn:Date.now()}),e)),{annotation:[],bookmark:[]}),u=a?[{id:p.get(),createdOn:Date.now(),val:a}]:[];return{id:p.get(),label:r,event:i,children:[],parent:e.id,createdOn:Date.now(),meta:c,artifacts:u,sideEffects:n,state:t,level:e.level+1}}function y(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if("production"!=={}.NODE_ENV){var o=ne[e],a=o?"function"==typeof o?o.apply(null,r):o:"unknown error nr: "+e;throw Error("[Immer] "+a)}throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function m(e){return!!e&&!!e[re]}function g(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===oe}(e)||Array.isArray(e)||!!e[te]||!(null===(t=e.constructor)||void 0===t||!t[te])||_(e)||P(e))}function b(e,t,r){void 0===r&&(r=!1),0===w(e)?(r?Object.keys:ae)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function w(e){var t=e[re];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:_(e)?2:P(e)?3:0}function O(e,t){return 2===w(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function A(e,t){return 2===w(e)?e.get(t):e[t]}function E(e,t,r){var n=w(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function _(e){return Y&&e instanceof Map}function P(e){return X&&e instanceof Set}function T(e){return e.o||e.t}function N(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=ie(e);delete t[re];for(var r=ae(t),n=0;n<r.length;n++){var o=r[n],a=t[o];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function D(e,t){return void 0===t&&(t=!1),j(e)||m(e)||!g(e)||(w(e)>1&&(e.set=e.add=e.clear=e.delete=k),Object.freeze(e),t&&b(e,(function(e,t){return D(t,!0)}),!0)),e}function k(){y(2)}function j(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function R(e){var t=ce[e];return t||y(18,e),t}function S(){return"production"==={}.NODE_ENV||q||y(0),q}function I(e,t){t&&(R("Patches"),e.u=[],e.s=[],e.v=t)}function L(e){x(e),e.p.forEach(M),e.p=null}function x(e){e===q&&(q=e.l)}function C(e){return q={p:[],l:q,h:e,m:!0,_:0}}function M(e){var t=e[re];0===t.i||1===t.i?t.j():t.O=!0}function U(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.g||R("ES5").S(t,e,n),n?(r[re].P&&(L(t),y(4)),g(e)&&(e=V(t,e),t.l||z(t,e)),t.u&&R("Patches").M(r[re].t,e,t.u,t.s)):e=V(t,r,[]),L(t),t.u&&t.v(t.u,t.s),e!==ee?e:void 0}function V(e,t,r){if(j(t))return t;var n=t[re];if(!n)return b(t,(function(o,a){return F(e,n,t,o,a,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return z(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=4===n.i||5===n.i?n.o=N(n.k):n.o;b(3===n.i?new Set(o):o,(function(t,a){return F(e,n,o,t,a,r)})),z(e,o,!1),r&&e.u&&R("Patches").R(n,r,e.u,e.s)}return n.o}function F(e,t,r,n,o,a){if("production"!=={}.NODE_ENV&&o===r&&y(5),m(o)){var i=V(e,o,a&&t&&3!==t.i&&!O(t.D,n)?a.concat(n):void 0);if(E(r,n,i),!m(i))return;e.m=!1}if(g(o)&&!j(o)){if(!e.h.F&&e._<1)return;V(e,o),t&&t.A.l||z(e,o)}}function z(e,t,r){void 0===r&&(r=!1),e.h.F&&e.m&&D(t,r)}function J(e,t){var r=e[re];return(r?T(r):e)[t]}function H(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function B(e){e.P||(e.P=!0,e.l&&B(e.l))}function $(e){e.o||(e.o=N(e.t))}function K(e,t,r){var n=_(t)?R("MapSet").N(t,r):P(t)?R("MapSet").T(t,r):e.g?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:S(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},o=n,a=ue;r&&(o=[n],a=se);var i=Proxy.revocable(o,a),c=i.revoke,u=i.proxy;return n.k=u,n.j=c,u}(t,r):R("ES5").J(t,r);return(r?r.A:S()).p.push(n),n}function Q(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return N(e)}p.ids=new Map;var W,q,G=typeof Symbol<"u"&&"symbol"==typeof Symbol("x"),Y=typeof Map<"u",X=typeof Set<"u",Z=typeof Proxy<"u"&&void 0!==Proxy.revocable&&typeof Reflect<"u",ee=G?Symbol.for("immer-nothing"):((W={})["immer-nothing"]=!0,W),te=G?Symbol.for("immer-draftable"):"__$immer_draftable",re=G?Symbol.for("immer-state"):"__$immer_state",ne={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available",21:function(e){return"produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '"+e+"'"},22:function(e){return"'current' expects a draft, got: "+e},23:function(e){return"'original' expects a draft, got: "+e},24:"Patching reserved attributes like __proto__, prototype and constructor is not allowed"},oe=""+Object.prototype.constructor,ae=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,ie=Object.getOwnPropertyDescriptors||function(e){var t={};return ae(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},ce={},ue={get:function(e,t){if(t===re)return e;var r,n,o,a=T(e);if(!O(a,t))return r=e,(o=H(a,t))?"value"in o?o.value:null===(n=o.get)||void 0===n?void 0:n.call(r.k):void 0;var i=a[t];return e.I||!g(i)?i:i===J(e.t,t)?($(e),e.o[t]=K(e.A.h,i,e)):i},has:function(e,t){return t in T(e)},ownKeys:function(e){return Reflect.ownKeys(T(e))},set:function(e,t,r){var n=H(T(e),t);if(n?.set)return n.set.call(e.k,r),!0;if(!e.P){var o=J(T(e),t),a=o?.[re];if(a&&a.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(r,o)&&(void 0!==r||O(e.t,t)))return!0;$(e),B(e)}return e.o[t]===r&&"number"!=typeof r&&(void 0!==r||t in e.o)||(e.o[t]=r,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==J(e.t,t)||t in e.t?(e.D[t]=!1,$(e),B(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=T(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}},defineProperty:function(){y(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){y(12)}},se={};b(ue,(function(e,t){se[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),se.deleteProperty=function(e,t){return"production"!=={}.NODE_ENV&&isNaN(parseInt(t))&&y(13),se.set.call(this,e,t,void 0)},se.set=function(e,t,r){return"production"!=={}.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&y(14),ue.set.call(this,e[0],t,r,e[0])};var fe=function(){function e(e){var t=this;this.g=Z,this.F=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var o=r;r=e;var a=t;return function(e){var t=this;void 0===e&&(e=o);for(var n=arguments.length,i=Array(n>1?n-1:0),c=1;c<n;c++)i[c-1]=arguments[c];return a.produce(e,(function(e){var n;return(n=r).call.apply(n,[t,e].concat(i))}))}}var i;if("function"!=typeof r&&y(6),void 0!==n&&"function"!=typeof n&&y(7),g(e)){var c=C(t),u=K(t,e,void 0),s=!0;try{i=r(u),s=!1}finally{s?L(c):x(c)}return typeof Promise<"u"&&i instanceof Promise?i.then((function(e){return I(c,n),U(e,c)}),(function(e){throw L(c),e})):(I(c,n),U(i,c))}if(!e||"object"!=typeof e){if(void 0===(i=r(e))&&(i=e),i===ee&&(i=void 0),t.F&&D(i,!0),n){var f=[],p=[];R("Patches").M(e,i,f,p),n(f,p)}return i}y(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return t.produceWithPatches(r,(function(t){return e.apply(void 0,[t].concat(o))}))};var n,o,a=t.produce(e,r,(function(e,t){n=e,o=t}));return typeof Promise<"u"&&a instanceof Promise?a.then((function(e){return[e,n,o]})):[a,n,o]},"boolean"==typeof e?.useProxies&&this.setUseProxies(e.useProxies),"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){g(e)||y(8),m(e)&&(e=function(e){return m(e)||y(22,e),function e(t){if(!g(t))return t;var r,n=t[re],o=w(t);if(n){if(!n.P&&(n.i<4||!R("ES5").K(n)))return n.t;n.I=!0,r=Q(t,o),n.I=!1}else r=Q(t,o);return b(r,(function(t,o){n&&A(n.t,t)===o||E(r,t,e(o))})),3===o?new Set(r):r}(e)}(e));var t=C(this),r=K(this,e,void 0);return r[re].C=!0,x(t),r},t.finishDraft=function(e,t){var r=e&&e[re];"production"!=={}.NODE_ENV&&(r&&r.C||y(9),r.I&&y(10));var n=r.A;return I(n,t),U(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!Z&&y(20),this.g=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var o=R("Patches").$;return m(e)?o(e,t):this.produce(e,(function(e){return o(e,t)}))},e}(),pe=new fe,le=pe.produce;function de(e){const t=new Map,{reducer:r,actions:o,getInitialState:a}=function(e,t={}){const{artifact:r,metadata:o,rootLabel:a="Root"}=t,i=h({state:e,label:a,initialArtifact:r,initialMetadata:o}),c={nodes:{[i.id]:i},root:i.id,current:i.id};return(0,n.oM)({name:"provenance-graph",initialState:c,reducers:{addMetadata(e,t){const{id:r,meta:n}=t.payload,o=e.nodes[r].meta,a=Object.keys(n).reduce(((e,t)=>(e[t]||(e[t]=[]),e[t].push({type:t,id:p.get(),val:n[t],createdOn:Date.now()}),e)),o);e.nodes[t.payload.id].meta=a},addArtifact(e,t){e.nodes[t.payload.id].artifacts.push({id:p.get(),createdOn:Date.now(),val:t.payload.artifact})},changeCurrent(e,t){e.current=t.payload},addNode(e,{payload:t}){e.nodes[t.id]=t,e.nodes[t.parent].children.push(t.id),e.current=t.id},load:(e,{payload:t})=>t}})}(e),i=(0,n.e)();i.startListening({matcher:(0,n.Q)(o.changeCurrent,o.addNode),effect:(e,r)=>{r.cancelActiveListeners(),t.forEach((t=>{const r=(0,n.Q)(o.addNode)(e),{skipOnNew:a}=t.config;a&&r||t.func(r?"new":"traversal")}))}});const c=(0,n.xC)({reducer:r,middleware:e=>e().prepend(i.middleware)});return{initialState:a(),get backend(){return c.getState()},get current(){return c.getState().nodes[c.getState().current]},get root(){return c.getState().nodes[c.getState().root]},currentChange(e,r){const n={id:p.get(),func:e,config:r};return t.set(n.id,n),()=>t.delete(n.id)},update:c.dispatch,...o}}pe.produceWithPatches.bind(pe),pe.setAutoFreeze.bind(pe),pe.setUseProxies.bind(pe),pe.applyPatches.bind(pe),pe.createDraft.bind(pe),pe.finishDraft.bind(pe);var he,ve=globalThis&&globalThis.__extends||(he=function(e,t){return(he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}he(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),ye=Object.prototype.hasOwnProperty;function me(e,t){return ye.call(e,t)}function ge(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);var n=[];for(var o in e)me(e,o)&&n.push(o);return n}function be(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function we(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0}function Oe(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Ae(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Ee(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(Ee(e[t]))return!0}else if("object"==typeof e)for(var n=ge(e),o=n.length,a=0;a<o;a++)if(Ee(e[n[a]]))return!0;return!1}function _e(e,t){var r=[e];for(var n in t){var o="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];typeof o<"u"&&r.push(n+": "+o)}return r.join("\n")}var Pe=function(e){function t(t,r,n,o,a){var i=this.constructor,c=e.call(this,_e(t,{name:r,index:n,operation:o,tree:a}))||this;return c.name=r,c.index=n,c.operation=o,c.tree=a,Object.setPrototypeOf(c,i.prototype),c.message=_e(t,{name:r,index:n,operation:o,tree:a}),c}return ve(t,e),t}(Error),Te=Pe,Ne=be,De={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=je(r,this.path);n&&(n=be(n));var o=Re(r,{op:"remove",path:this.from}).removed;return Re(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=je(r,this.from);return Re(r,{op:"add",path:this.path,value:be(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:xe(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},ke={add:function(e,t,r){return we(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:De.move,copy:De.copy,test:De.test,_get:De._get};function je(e,t){if(""==t)return e;var r={op:"_get",path:t};return Re(e,r),r.value}function Re(e,t,r,n,o,a){if(void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===a&&(a=0),r&&("function"==typeof r?r(t,0,e,t.path):Ie(t,0)),""===t.path){var i={newDocument:e};if("add"===t.op)return i.newDocument=t.value,i;if("replace"===t.op)return i.newDocument=t.value,i.removed=e,i;if("move"===t.op||"copy"===t.op)return i.newDocument=je(e,t.from),"move"===t.op&&(i.removed=e),i;if("test"===t.op){if(i.test=xe(e,t.value),!1===i.test)throw new Te("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i.newDocument=e,i}if("remove"===t.op)return i.removed=e,i.newDocument=null,i;if("_get"===t.op)return t.value=e,i;if(r)throw new Te("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return i}n||(e=be(e));var c=(t.path||"").split("/"),u=e,s=1,f=c.length,p=void 0,l=void 0,d=void 0;for(d="function"==typeof r?r:Ie;;){if((l=c[s])&&-1!=l.indexOf("~")&&(l=Ae(l)),o&&("__proto__"==l||"prototype"==l&&s>0&&"constructor"==c[s-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===p&&(void 0===u[l]?p=c.slice(0,s).join("/"):s==f-1&&(p=t.path),void 0!==p&&d(t,0,e,p)),s++,Array.isArray(u)){if("-"===l)l=u.length;else{if(r&&!we(l))throw new Te("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);we(l)&&(l=~~l)}if(s>=f){if(r&&"add"===t.op&&l>u.length)throw new Te("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);if(!1===(i=ke[t.op].call(t,u,l,e)).test)throw new Te("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}}else if(s>=f){if(!1===(i=De[t.op].call(t,u,l,e)).test)throw new Te("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}if(u=u[l],r&&s<f&&(!u||"object"!=typeof u))throw new Te("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}function Se(e,t,r,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!0),r&&!Array.isArray(t))throw new Te("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=be(e));for(var a=new Array(t.length),i=0,c=t.length;i<c;i++)a[i]=Re(e,t[i],r,!0,o,i),e=a[i].newDocument;return a.newDocument=e,a}function Ie(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new Te("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(!De[e.op])throw new Te("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r);if("string"!=typeof e.path)throw new Te("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new Te('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new Te("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new Te("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&Ee(e.value))throw new Te("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);if(r)if("add"==e.op){var o=e.path.split("/").length,a=n.split("/").length;if(o!==a+1&&o!==a)throw new Te("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new Te("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var i=Le([{op:"_get",path:e.from,value:void 0}],r);if(i&&"OPERATION_PATH_UNRESOLVABLE"===i.name)throw new Te("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}function Le(e,t,r){try{if(!Array.isArray(e))throw new Te("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Se(be(t),be(e),r||!0);else{r=r||Ie;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(e){if(e instanceof Te)return e;throw e}}function xe(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,o,a=Array.isArray(e),i=Array.isArray(t);if(a&&i){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!xe(e[r],t[r]))return!1;return!0}if(a!=i)return!1;var c=Object.keys(e);if((n=c.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(c[r]))return!1;for(r=n;0!=r--;)if(!xe(e[o=c[r]],t[o]))return!1;return!0}return e!=e&&t!=t}const Ce=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Te,_areEquals:xe,applyOperation:Re,applyPatch:Se,applyReducer:function(e,t,r){var n=Re(e,t);if(!1===n.test)throw new Te("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument},deepClone:Ne,getValueByPointer:je,validate:Le,validator:Ie},Symbol.toStringTag,{value:"Module"}));var Me=new WeakMap,Ue=function(e){this.observers=new Map,this.obj=e},Ve=function(e,t){this.callback=e,this.observer=t};function Fe(e,t){void 0===t&&(t=!1);var r=Me.get(e.object);ze(r.value,e.object,e.patches,"",t),e.patches.length&&Se(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function ze(e,t,r,n,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var a=ge(t),i=ge(e),c=!1,u=i.length-1;u>=0;u--){var s=e[p=i[u]];if(!me(t,p)||void 0===t[p]&&void 0!==s&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&r.push({op:"test",path:n+"/"+Oe(p),value:be(s)}),r.push({op:"remove",path:n+"/"+Oe(p)}),c=!0):(o&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}));else{var f=t[p];"object"==typeof s&&null!=s&&"object"==typeof f&&null!=f&&Array.isArray(s)===Array.isArray(f)?ze(s,f,r,n+"/"+Oe(p),o):s!==f&&(o&&r.push({op:"test",path:n+"/"+Oe(p),value:be(s)}),r.push({op:"replace",path:n+"/"+Oe(p),value:be(f)}))}}if(c||a.length!=i.length)for(u=0;u<a.length;u++){var p;!me(e,p=a[u])&&void 0!==t[p]&&r.push({op:"add",path:n+"/"+Oe(p),value:be(t[p])})}}}function Je(e,t,r){void 0===r&&(r=!1);var n=[];return ze(e,t,n,"",r),n}const He=Object.freeze(Object.defineProperty({__proto__:null,compare:Je,generate:Fe,observe:function(e,t){var r,n=function(e){return Me.get(e)}(e);if(n){var o=function(e,t){return e.observers.get(t)}(n,t);r=o&&o.observer}else n=new Ue(e),Me.set(e,n);if(r)return r;if(r={},n.value=be(e),t){r.callback=t,r.next=null;var a=function(){Fe(r)},i=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",i),window.addEventListener("keyup",i),window.addEventListener("mousedown",i),window.addEventListener("keydown",i),window.addEventListener("change",i))}return r.patches=[],r.object=e,r.unobserve=function(){Fe(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),typeof window<"u"&&(window.removeEventListener("mouseup",i),window.removeEventListener("keyup",i),window.removeEventListener("mousedown",i),window.removeEventListener("keydown",i),window.removeEventListener("change",i))},n.observers.set(t,new Ve(t,r)),r},unobserve:function(e,t){t.unobserve()}},Symbol.toStringTag,{value:"Module"}));Object.assign({},Ce,He,{JsonPatchError:Pe,deepClone:be,escapePathComponent:Oe,unescapePathComponent:Ae});var Be=(e=>(e.TRAVERSAL_START="Traversal_Start",e.TRAVERSAL_END="Traversal_End",e))(Be||{});function $e(e,t){const r=e.state;if("checkpoint"===r.type)return r.val;const{checkpointRef:n}=r,o=t[n],a=Qe(o,e,t);a.shift();const i=a.map((e=>t[e])).map((e=>e.state.val)).reduce(((e,t)=>[...e,...t]),[]);return Se($e(o,t),be(i),!0,!1).newDocument}function Ke({registry:e,initialState:t}){let r=!1;const n=o(),a=de(t);function i(e){return a.backend.nodes[e]}n.listen(Be.TRAVERSAL_START,(()=>{r=!0})),n.listen(Be.TRAVERSAL_END,(()=>{r=!1}));const c={add(e,t=a.current.id){a.update(a.addMetadata({id:t,meta:e}))},latestOfType:(e,t=a.current.id)=>a.backend.nodes[t].meta[e]?.at(-1),allOfType:(e,t=a.current.id)=>a.backend.nodes[t].meta[e],latest(e=a.current.id){const t=a.backend.nodes[e].meta,r=Object.keys(t).reduce(((e,r)=>{const n=t[r].at(-1);return n&&(e[r]=n),e}),{});return Object.keys(r).length>0?r:void 0},all:(e=a.current.id)=>a.backend.nodes[e].meta,types:(e=a.current.id)=>Object.keys(a.backend.nodes[e].meta)},u={add(e,t=a.current.id){a.update(a.addArtifact({id:t,artifact:e}))},latest:(e=a.current.id)=>a.backend.nodes[e].artifacts.at(-1),all:(e=a.current.id)=>a.backend.nodes[e].artifacts},s={add(e,t=a.current.id){c.add({annotation:e},t)},latest:(e=a.current.id)=>c.latestOfType("annotation",e)?.val,all:(e=a.current.id)=>c.allOfType("annotation",e)?.map((e=>e.val))},f={add(e=a.current.id){c.add({bookmark:!0},e)},remove(e=a.current.id){c.add({bookmark:!1},e)},is:(e=a.current.id)=>Boolean(c.latestOfType("bookmark",e)?.val),toggle(e=a.current.id){f.is(e)?f.remove(e):f.add(e)}};return{registry:e,get isTraversing(){return r},getState:(e=a.current)=>$e(e,a.backend.nodes),graph:a,get current(){return a.current},get root(){return a.root},record({label:e,state:t,sideEffects:r,eventType:n,onlySideEffects:o=!1}){let i=null,c=null;const u=$e(this.current,this.graph.backend.nodes);if(o)c={type:"checkpoint",val:t};else{const e=Je(u,t);c="checkpoint"===function(e,t){const r=Object.keys(e).length;return new Set(t.map((e=>e.path.split("/")[0]))).size<r/2?"patch":"checkpoint"}(t,e)?{type:"checkpoint",val:t}:{type:"patch",val:e,checkpointRef:"checkpoint"===this.current.state.type?this.current.id:this.current.state.checkpointRef}}if(!c)throw new Error(`Could not calculate new state. Previous state is: ${JSON.stringify(this.current.state,null,2)}`);if(i=v({label:e,state:c,parent:this.current,sideEffects:r,event:n}),!i)throw new Error("State Node creation failed!");a.update(a.addNode(i))},async apply(t,r){const n=e.get(r.type),o=$e(this.current,this.graph.backend.nodes);if(n.config.hasSideEffects){const{do:e=r,undo:a}=n.func(r.payload);this.record({label:t,state:o,sideEffects:{do:[e],undo:[a]},eventType:n.config.eventType})}else{const e=n.func(o,r.payload);this.record({label:t,state:e,sideEffects:{do:[],undo:[]},eventType:n.config.eventType})}},async to(t){n.fire(Be.TRAVERSAL_START);const r=Qe(a.current,a.backend.nodes[t],a.backend.nodes),o=[];for(let e=0;e<r.length-1;++e){const t=i(r[e]),n=i(r[e+1]);We(t,n)?l(t)&&o.push(...t.sideEffects.undo):l(n)&&o.push(...n.sideEffects.do)}for(const t of o){const r=e.get(t.type).func;await r(t.payload)}a.update(a.changeCurrent(t)),n.fire(Be.TRAVERSAL_END)},undo(){const{current:e}=a;return l(e)?this.to(e.parent):Promise.resolve(console.warn("Already at root!"))},redo(e="latest"){const{current:t}=a;return t.children.length>0?this.to(t.children["oldest"===e?0:t.children.length-1]):Promise.resolve(console.warn("Already at latest in this branch!"))},currentChange:(e,t=!1)=>a.currentChange(e,{skipOnNew:t}),done(){console.log("Setup later for URL sharing.")},tree:()=>qe(a.root,a.backend.nodes),on(e,t){n.listen(e,t)},export:()=>JSON.stringify(a.backend),import(e){const t=JSON.parse(e),r=t.current;t.current=t.root,a.update(a.load(t)),this.to(r)},metadata:c,artifact:u,annotations:s,bookmarks:f}}function Qe(e,t,r){const n=function(e,t,r){let[n,o]=[e,t];n.level>o.level&&([n,o]=[o,n]);let a=o.level-n.level;for(;l(o)&&0!==a;)o=r[o.parent],a-=1;if(n.id===o.id)return n.id;for(;n.id!==o.id;)l(n)&&(n=r[n.parent]),l(o)&&(o=r[o.parent]);return n.id}(e,t,r),o=r[n],a=[],i=[];let[c,u]=[e,t];for(;c.id!==o.id;)a.push(c),l(c)&&(c=r[c.parent]);for(a.push(c);u.id!==o.id;)i.push(u),l(u)&&(u=r[u.parent]);const s=i.reverse();return[...a,...s].map((e=>e.id))}function We(e,t){if(l(e)&&e.parent===t.id)return!0;if(l(t)&&t.parent===e.id)return!1;throw new Error("Incorrect use of function. Nodes are not connected to each other.")}function qe(e,t){return{...e,children:e.children.map((e=>qe(t[e],t))),name:`${e.label}`}}function Ge(e){return 2===e.length?le(e):e}!function(){function e(t){if(!g(t))return t;if(Array.isArray(t))return t.map(e);if(_(t))return new Map(Array.from(t.entries()).map((function(t){return[t[0],e(t[1])]})));if(P(t))return new Set(Array.from(t).map(e));var r=Object.create(Object.getPrototypeOf(t));for(var n in t)r[n]=e(t[n]);return O(t,te)&&(r[te]=t[te]),r}function t(t){return m(t)?e(t):t}var r="add";!function(e,t){ce[e]||(ce[e]=t)}("Patches",{$:function(t,n){return n.forEach((function(n){for(var o=n.path,a=n.op,i=t,c=0;c<o.length-1;c++){var u=w(i),s=""+o[c];0!==u&&1!==u||"__proto__"!==s&&"constructor"!==s||y(24),"function"==typeof i&&"prototype"===s&&y(24),"object"!=typeof(i=A(i,s))&&y(15,o.join("/"))}var f=w(i),p=e(n.value),l=o[o.length-1];switch(a){case"replace":switch(f){case 2:return i.set(l,p);case 3:y(16);default:return i[l]=p}case r:switch(f){case 1:return"-"===l?i.push(p):i.splice(l,0,p);case 2:return i.set(l,p);case 3:return i.add(p);default:return i[l]=p}case"remove":switch(f){case 1:return i.splice(l,1);case 2:return i.delete(l);case 3:return i.delete(n.value);default:return delete i[l]}default:y(17,a)}})),t},R:function(e,n,o,a){switch(e.i){case 0:case 4:case 2:return c=n,u=o,s=a,f=(i=e).t,p=i.o,void b(i.D,(function(e,n){var o=A(f,e),a=A(p,e),i=n?O(f,e)?"replace":r:"remove";if(o!==a||"replace"!==i){var l=c.concat(e);u.push("remove"===i?{op:i,path:l}:{op:i,path:l,value:a}),s.push(i===r?{op:"remove",path:l}:"remove"===i?{op:r,path:l,value:t(o)}:{op:"replace",path:l,value:t(o)})}}));case 5:case 1:return function(e,n,o,a){var i=e.t,c=e.D,u=e.o;if(u.length<i.length){var s=[u,i];i=s[0],u=s[1];var f=[a,o];o=f[0],a=f[1]}for(var p=0;p<i.length;p++)if(c[p]&&u[p]!==i[p]){var l=n.concat([p]);o.push({op:"replace",path:l,value:t(u[p])}),a.push({op:"replace",path:l,value:t(i[p])})}for(var d=i.length;d<u.length;d++){var h=n.concat([d]);o.push({op:r,path:h,value:t(u[d])})}i.length<u.length&&a.push({op:"replace",path:n.concat(["length"]),value:i.length})}(e,n,o,a);case 3:return function(e,t,n,o){var a=e.t,i=e.o,c=0;a.forEach((function(e){if(!i.has(e)){var a=t.concat([c]);n.push({op:"remove",path:a,value:e}),o.unshift({op:r,path:a,value:e})}c++})),c=0,i.forEach((function(e){if(!a.has(e)){var i=t.concat([c]);n.push({op:r,path:i,value:e}),o.unshift({op:"remove",path:i,value:e})}c++}))}(e,n,o,a)}var i,c,u,s,f,p},M:function(e,t,r,n){r.push({op:"replace",path:[],value:t===ee?void 0:t}),n.push({op:"replace",path:[],value:e})}})}();class Ye{static create(){return new Ye}constructor(){this.registry=new Map}has(e){return this.registry.has(e)}register(e,t,r){const o=2===t.length;if(t.length>2)throw new Error("Incorrect action function signature. Action function can only have two arguments at most!");if(this.has(e))throw new Error(`Already registered: ${e}`);const{label:a=e,eventType:i=e}=r||{};return this.registry.set(e,{func:Ge(t),config:{hasSideEffects:!o,label:"string"==typeof a?()=>a:a,eventType:i}}),(0,n.PH)(e)}get(e){const t=this.registry.get(e);if(!t)throw new Error(`Not registered: ${e}`);return t}}}}]);
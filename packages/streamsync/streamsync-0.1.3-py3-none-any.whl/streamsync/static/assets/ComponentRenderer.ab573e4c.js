import{F as A,_ as w,d as K,i as k,a as I,t as ne,c as h,o as T,b as V,e as u,f as P,u as M,g as X,h as oe,r as B,w as J,j as F,p as E,k as se,l as ae,m as z,v as H,n as re,q as ce,s as le,x as U,y as q,z as G,A as ie,B as de,C as ue,D as pe}from"./index.d8bb0c68.js";function Y(c){const v=/[\\]?@{([^}]*)}/g;function y(n){var _,r;const a={};for(let t=0;t<n.length-1;t++){const e=n[t],{componentId:o}=e,{type:s}=c.getComponentById(o);if(s!=="repeater"||t+1>=n.length)continue;const m=n.slice(0,t+1),D=n.slice(0,t+2),{instanceNumber:S}=D.at(-1),$=p(m,"repeaterObject");if(!$)continue;const C=Object.entries($),j=p(m,"keyVariable"),O=p(m,"valueVariable");a[j]=(_=C[S])==null?void 0:_[0],a[O]=(r=C[S])==null?void 0:r[1]}return a}function i(n,a){if(n==null)return"";const _=y(a);return n.replace(v,(t,e)=>{if(t.charAt(0)=="\\")return t.substring(1);const o=e.trim();if(!o)return"";const s=c.evaluateExpression(o,_);return typeof s=="undefined"?"":typeof s=="object"?JSON.stringify(s):s})}function d(n){const{componentId:a}=n.at(-1),_=c.getComponentById(a);if(!_)return;const r={},{fields:t}=c.getComponentDefinition(_.type);if(!!t)return Object.keys(t).forEach(e=>{r[e]=p(n,e)}),r}function p(n,a){var D,S,$;const{componentId:_}=n.at(-1),r=c.getComponentById(_),{fields:t}=c.getComponentDefinition(r.type),e=(D=r.content)==null?void 0:D[a],o=t[a].default,s=i(e,n),m=t[a].type;if(m==A.Object||m==A.KeyValue){if(!s)return(S=JSON.parse(o))!=null?S:null;if(typeof s!="string")return s;let C;try{C=JSON.parse(s)}catch{return($=JSON.parse(o))!=null?$:null}return C}else if(m==A.Number){const C=parseFloat(s);return typeof C===void 0||Number.isNaN(C)?parseFloat(o!=null?o:"0"):C}else return m==A.IdKey?e:typeof s=="undefined"||s===null||s===""?o!=null?o:"":s}return{getEvaluatedFields:d}}const ve={class:"ChildlessPlaceholder"},_e={class:"content"},me={class:"title"},fe={key:0,class:"message"},ge=K({__name:"ChildlessPlaceholder",props:{componentId:null},setup(c){const v=c,y=10,i=k(I.core),{componentId:d}=ne(v),p=h(()=>i.getComponentById(d.value)),n=h(()=>i.getComponentDefinition(p.value.type)),a=(r,t)=>{const o=r.map(m=>i.getComponentDefinition(m)).map(m=>m==null?void 0:m.name);return`${o.slice(0,-1).join(", ")} ${o.length>1?t:""} ${o.at(-1)}`},_=h(()=>{const r=i.getContainableTypes(d.value);let t;return r.length<=y&&(t=`You can add ${a(r,"and")} components`),t});return(r,t)=>(T(),V("div",ve,[u("div",_e,[u("div",me,[u("h2",null,"Empty "+P(M(n).name),1)]),M(_)?(T(),V("div",fe,P(M(_)),1)):X("",!0)])]))}});var he=w(ge,[["__scopeId","data-v-0ac82581"]]);const ye=c=>()=>F("div",`Component type ${c} not supported.`),Ce={props:["componentId","instancePath","instanceData"],setup(c){const v=k(I.core),y=k(I.builderManager),i=c.componentId,d=h(()=>v.getComponentById(i)),p=oe[d.value.type];if(!p)return ye(d.value.type);const n=c.instancePath,a=c.instanceData,_=Y(v),r=h(()=>_.getEvaluatedFields(n)),t=h(()=>v.getComponents(i,!0)),e=h(()=>!!y&&y.getMode()!="preview"),o=()=>{if(!(t.value.length>0))return F(he,{componentId:d.value.id})},s=(l,g=0)=>F(Q,{componentId:l,key:`${l}:${g}`,instancePath:[...n,{componentId:l,instanceNumber:g}],instanceData:[...a,B(null)]}),m=(l=0,g=()=>!0,f=!1)=>{const b=N=>F("div",{"data-streamsync-slot-of-id":i,"data-streamsync-position":N}),x=e.value&&!f,L=t.value.filter(g).map((N,W)=>[s(N.id,l),...x?[b(W+1)]:[]]);return[...x?[b(0)]:[]].concat(L.flat())};E(I.evaluatedFields,r),E(I.componentId,i),E(I.isBeingEdited,e),E(I.instancePath,n),E(I.instanceData,a),E(I.renderProxiedComponent,s),E(I.getChildrenVNodes,m);const S={"data-streamsync-id":i,"data-streamsync-instance-path":(l=>l.map(g=>`${g.componentId}:${g.instanceNumber}`).join(","))(n)},$=B(!1);J(()=>(y==null?void 0:y.getSelectedId())==i,l=>{$.value=l}),J(r,()=>{$.value=!1});const C=h(()=>t.value.length==0),j=h(()=>v.isComponentVisible(i)),O=l=>{if(!l.startsWith("$"))return f=>v.forwardEvent(f,n);if(l.startsWith("$goToPage_")){const f=l.substring(10);return b=>v.setActivePageFromKey(f)}return null},Z=h(()=>{var g;const l={};if(d.value.binding){const f=d.value.binding.eventType,b=`on${f.charAt(0).toUpperCase()}${f.slice(1)}`;l[b]=x=>v.forwardEvent(x,n)}return Object.entries((g=d.value.handlers)!=null?g:{}).forEach(([f,b])=>{const x=`on${f.charAt(0).toUpperCase()}${f.slice(1)}`;l[x]=O(b)}),l}),ee=h(()=>{var f;const l=(f=v.getComponentDefinition(d.value.type))==null?void 0:f.fields;if(!l)return;const g={};return Object.keys(l).forEach(b=>{!l[b].applyStyleVariable||!r.value[b]||(g[`--${b}`]=r.value[b])}),g}),te=function(){return{class:{component:!0,childless:C.value,selected:$.value},style:{...ee.value,...j.value?{}:{display:"none"}},...S,...Z.value,draggable:e.value}};return()=>{const l=e.value?o():void 0,g=({instanceNumber:x=0,componentFilter:L=()=>!0,positionlessSlot:N=!1})=>C.value?N?void 0:l:m(x,L,N),f={...te()};return F(p,f,{default:g})}}};var Q=w(Ce,[["__scopeId","data-v-4c0b4b62"]]);const R=c=>(q("data-v-c62a2f1c"),c=c(),G(),c),be=R(()=>u("i",{class:"ri-notification-2-line ri-xl"},null,-1)),Ie={class:"counter"},$e=R(()=>u("div",{class:"balloonFlash"},null,-1)),xe={class:"main"},Se=R(()=>u("i",{class:"ri-close-line"},null,-1)),Ee=R(()=>u("i",{class:"ri-error-warning-fill ri-xl"},null,-1)),Te=[Ee],Ne={class:"content"},Pe={class:"title"},Ve={class:"time"},Be={class:"message"},De=K({__name:"RendererNotifications",setup(c){const y=k(I.core),i=B(!1),d=B(null),p=se([]),n=r=>{const{type:t,title:e,message:o,code:s}=r;p.unshift({type:t,title:e,message:o,code:s,timestampReceived:new Date}),p.splice(100),d.value.classList.remove("alert"),d.value.offsetWidth,d.value.classList.add("alert")};ae(()=>{y.addMailSubscription("notification",n)});const a=()=>{p.length!=0&&(i.value=!i.value)},_=()=>{p.splice(0),i.value=!1};return(r,t)=>z((T(),V("div",{class:"RendererNotifications",onClick:a},[u("div",{class:"balloon",ref_key:"balloon",ref:d,title:"Toggle notifications"},[be,u("div",Ie,P(p.length),1)],512),$e,z(u("div",xe,[u("div",{class:"clearContainer"},[u("button",{onClick:_},[Se,re(" Clear all ")])]),(T(!0),V(ce,null,le(p,(e,o)=>(T(),V("div",{class:"notification",key:o},[u("div",{class:U(["icon",e.type])},Te,2),u("div",Ne,[u("header",null,[u("strong",Pe,P(e.title),1),u("span",Ve,P(e.timestampReceived.toLocaleTimeString()),1)]),u("div",Be,P(e.message),1)])]))),128))],512),[[H,i.value]])],512)),[[H,p.length>0]])}});var Fe=w(De,[["__scopeId","data-v-c62a2f1c"]]);const Me=c=>(q("data-v-4b606cac"),c=c(),G(),c),ke=Me(()=>u("div",{class:"loadingBar"},null,-1)),Ae={class:"rootComponentArea"},we=K({__name:"ComponentRenderer",setup(c){const v=k(I.core),y=Y(v),i=v.getComponents();i.length==0&&console.error("No pages found.");const d=[{componentId:"root",instanceNumber:0}],p=[B(null)],n=B(i[0]),a=h(()=>y.getEvaluatedFields(d)),_=h(()=>({"--accentColor":a.value.accentColor,"--emptinessColor":a.value.emptinessColor,"--containerBackgroundColor":a.value.parentIdBackgroundColor,"--primaryTextColor":a.value.primaryTextColor,"--secondaryTextColor":a.value.secondaryTextColor,"--separatorColor":a.value.separatorColor})),r=h(()=>v.isMessagePending.value);J(()=>a.value.appName,e=>{t(e)},{immediate:!0});function t(e){const o=v.getMode();let s;e&&o=="edit"?s=`${e} | Streamsync Builder`:!e&&o=="edit"?s="Streamsync Builder":e&&o=="run"?s=`${e}`:!e&&o=="run"&&(s="Streamsync App"),document.title=s}return(e,o)=>(T(),V("div",{class:U(["ComponentRenderer",{loadingActive:M(r)}]),tabindex:"-1",style:pe(M(_))},[ie(Fe,{class:"notifications"}),ke,u("div",Ae,[n.value?(T(),de(Q,{key:0,"component-id":n.value.id,"instance-path":d,"instance-data":p},null,8,["component-id"])):X("",!0),ue(e.$slots,"default",{},void 0,!0)])],6))}});var Oe=w(we,[["__scopeId","data-v-4b606cac"]]);export{Oe as default};
